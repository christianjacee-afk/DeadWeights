<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DEADWEIGHTS // THE_GRAVE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
</head>

<body class="crt">
  <!-- AUTH / REG -->
  <div id="registration-screen" class="screen hidden">
    <div class="morbid-title-main pulse">DEADWEIGHTS</div>
    <div class="grave-box auth-box">
      <div class="grave-header">RECRUIT_INDUCTION</div>
      <div class="grave-body">
        <div id="reg-step-1">
          <input id="reg-email" type="email" placeholder="EMAIL_ADDRESS" autocomplete="email">
          <input id="reg-pass" type="password" placeholder="CREATE_PASSCODE" autocomplete="new-password">
          <input id="reg-confirm" type="password" placeholder="CONFIRM_PASSCODE" autocomplete="new-password">
          <button id="nextStepBtn" class="grave-btn">CONTINUE_INDUCTION</button>
          <div class="small-warn" id="reg-error"></div>
        </div>

        <div id="reg-step-2" class="hidden">
          <input id="reg-username" placeholder="ASSIGN_CALLSIGN" maxlength="20">
          <p class="small-label">SELECT INITIAL CALLING_CARD:</p>
          <div id="initial-card-picker" class="card-grid"></div>

          <p class="small-label">SELECT INITIAL GRAVE_TAG:</p>
          <div id="initial-tag-picker" class="tag-grid"></div>

          <button id="finalizeRegBtn" class="grave-btn">FINALIZE_ENTRY</button>
          <div class="small-warn" id="reg2-error"></div>
        </div>

        <button id="returnToLoginBtn" class="grave-btn-alt">RETURN_TO_LOGIN</button>
      </div>
    </div>
  </div>

  <div id="auth-screen" class="screen">
    <div class="morbid-title-main pulse">DEADWEIGHTS</div>
    <div class="grave-box auth-box">
      <div class="grave-header">EXISTING_ENTITY_ACCESS</div>
      <div class="grave-body">
        <input id="email" type="email" placeholder="USER_ID" autocomplete="email">
        <input id="password" type="password" placeholder="PASS_CODE" autocomplete="current-password">
        <button id="loginBtn" class="grave-btn">RESURRECT</button>
        <button id="showRegBtn" class="grave-btn-alt">NEW_RECRUIT_ENTRY</button>
        <div class="small-warn" id="login-error"></div>
      </div>
    </div>
  </div>

  <!-- APP -->
  <div id="app" class="screen hidden">
    <header class="grave-nav">
      <div class="logo pulse">DEADWEIGHTS // <span id="header-callsign"></span></div>
      <div class="nav-controls">
        <button data-tab="feed-panel" class="mini-btn tabBtn">FEED</button>
        <button data-tab="plans-panel" class="mini-btn tabBtn">PLANS</button>
        <button data-tab="friends-panel" class="mini-btn tabBtn">FRIENDS</button>
        <button data-tab="settings-panel" class="mini-btn tabBtn">SETTINGS</button>
        <button id="logoutBtn" class="mini-btn danger">DISCONNECT</button>
      </div>
    </header>

    <div class="grave-grid">
      <!-- LEFT PROFILE -->
      <aside class="col">
        <div class="grave-box">
          <div id="user-calling-card" class="calling-card card-rust">
            <div class="card-sigil"></div>
            <div class="card-title">
              <span class="card-name" id="profileUsername">SUBJECT</span>
              <span class="card-sub" id="user-rank">NEWBORN</span>
            </div>
          </div>

          <div class="grave-body">
            <div id="user-grave-tag" class="grave-tag tag-rust"><span class="tag-text">CADAVER</span></div>

            <div class="stats-line">
              <div class="stat"><small>CARVINGS</small><b id="stat-count">0</b></div>
              <div class="stat"><small>XP</small><b id="stat-xp">0</b></div>
            </div>

            <div class="xp-wrap">
              <div class="xp-bar"><div id="xp-fill" class="xp-fill"></div></div>
              <div class="xp-text"><span id="xp-now">0</span> / <span id="xp-next">100</span></div>
            </div>
          </div>
        </div>

        <div class="grave-box">
          <div class="grave-header">LEADERBOARD</div>
          <div id="leaderboard" class="grave-body small-text"></div>
        </div>

        <div class="grave-box hidden" id="admin-panel">
          <div class="grave-header">ADMIN_CONSOLE</div>
          <div class="grave-body">
            <p class="small-label">POST MODERATION</p>
            <button id="admin-nuke-my-feed" class="grave-btn danger-btn">NUKE_MY_LAST_20_POSTS</button>
            <p class="small-note">
              Admin powers are controlled by Firebase custom claims (safe). Client code does not “set admin”.
            </p>
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <main class="col-main">
        <!-- FEED -->
        <section id="feed-panel">
          <div class="grave-box">
            <div class="grave-header">BROADCAST_CARVING</div>
            <div class="grave-body">
              <textarea id="statusText" placeholder="SHARE INTEL..."></textarea>
              <div class="row">
                <button id="postStatusBtn" class="grave-btn">TRANSMIT</button>
              </div>
              <div class="small-note">You can delete your own transmissions. Admins can delete anything.</div>
            </div>
          </div>
          <div id="feed-content"></div>
        </section>

        <!-- PLANS -->
        <section id="plans-panel" class="hidden">
          <div class="grave-box">
            <div class="grave-header">WORKOUT_PLAN_INDEX</div>
            <div class="grave-body">
              <div id="plan-grid" class="plan-grid"></div>
              <div class="divider"></div>
              <div class="two-col">
                <div>
                  <div class="grave-header slim">ACTIVE_PLAN</div>
                  <div class="grave-body inner">
                    <div id="active-plan-name" class="big-green">NONE_SELECTED</div>
                    <div id="today-workout" class="small-text"></div>
                  </div>
                </div>
                <div>
                  <div class="grave-header slim">LOG_TODAY</div>
                  <div class="grave-body inner">
                    <select id="day-picker"></select>
                    <select id="plan-ex-picker"></select>
                    <div class="row">
                      <input id="log-sets" type="number" placeholder="SETS" min="1" step="1">
                      <input id="log-reps" type="number" placeholder="REPS" min="1" step="1">
                      <input id="log-w" type="number" placeholder="LBS" min="0" step="1">
                    </div>
                    <button id="submitLogBtn" class="grave-btn">RECORD_CARVING</button>
                    <div class="small-note">Auto-PR + estimated 1RM tracked per exercise.</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grave-box">
            <div class="grave-header">PERSONAL_RECORDS</div>
            <div id="prList" class="grave-body index-container"></div>
          </div>
        </section>

        <!-- FRIENDS -->
        <section id="friends-panel" class="hidden">
          <div class="grave-box">
            <div class="grave-header">SEARCH_ENTITIES</div>
            <div class="grave-body">
              <input id="userSearch" placeholder="SEARCH CALLSIGN...">
              <div id="search-results"></div>
              <div class="small-note">Searches usernames. Add to your coven.</div>
            </div>
          </div>

          <div class="grave-box">
            <div class="grave-header">THE_COVEN (FRIENDS)</div>
            <div id="friends-list" class="grave-body"></div>
          </div>
        </section>

        <!-- SETTINGS -->
        <section id="settings-panel" class="hidden">
          <div class="grave-box">
            <div class="grave-header">USER_PARAMETERS</div>
            <div class="grave-body">
              <p class="small-label">CHANGE CALLSIGN:</p>
              <input id="new-username" placeholder="NEW_CALLSIGN" maxlength="20">
              <button id="renameBtn" class="grave-btn">RENAME_ENTITY</button>

              <div class="divider"></div>

              <p class="small-label">CALLING_CARD_VISUALS:</p>
              <div id="settings-card-picker" class="card-grid"></div>
              <button id="updateCardBtn" class="grave-btn">UPDATE_CARD</button>

              <div class="divider"></div>

              <p class="small-label">GRAVE_TAG_VISUALS:</p>
              <div id="settings-tag-picker" class="tag-grid"></div>
              <button id="updateTagBtn" class="grave-btn">UPDATE_TAG</button>

              <div class="divider"></div>

              <p class="small-label">DANGER_ZONE:</p>
              <button id="deleteAccountBtn" class="grave-btn danger-btn">REQUEST_ACCOUNT_PURGE</button>
              <div class="small-note">
                (Client can’t delete auth users safely. This logs a purge request in Firestore for admin review.)
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- RIGHT SIDEBAR (QUICK LOG) -->
      <aside class="col">
        <div class="grave-box">
          <div class="grave-header">QUICK_LOG</div>
          <div class="grave-body">
            <select id="quick-cat"></select>
            <select id="quick-ex"></select>
            <div class="row">
              <input id="quick-sets" type="number" placeholder="SETS" min="1" step="1">
              <input id="quick-reps" type="number" placeholder="REPS" min="1" step="1">
              <input id="quick-w" type="number" placeholder="LBS" min="0" step="1">
            </div>
            <button id="quickLogBtn" class="grave-btn">RECORD_CARVING</button>
          </div>
        </div>

        <div class="grave-box">
          <div class="grave-header">SYSTEM_NOTES</div>
          <div class="grave-body small-text">
            <div class="note-line">• Calling cards are animated CSS skins.</div>
            <div class="note-line">• Rank = XP thresholds (game-style).</div>
            <div class="note-line">• PR = best weight + best est. 1RM per exercise.</div>
            <div class="note-line">• Delete your own posts from feed.</div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
